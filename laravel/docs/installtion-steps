sudo apt update
sudo apt install -y software-properties-common ca-certificates lsb-release apt-transport-https

sudo add-apt-repository ppa:ondrej/php -y
sudo apt update

# Install PHP 8.4 + common extensions
sudo apt install -y php8.4-cli php8.4-fpm php8.4-mbstring php8.4-xml php8.4-curl php8.4-zip php8.4-intl php8.4-gd php8.4-mysql php8.4-bcmath

# Make CLI use 8.4
sudo update-alternatives --set php /usr/bin/php8.4

php -v
sudo apt install composer
sudo apt install npm

######################################################

composer create-project laravel/laravel webapp

cd webapp

composer require laravel/jetstream
composer require livewire/livewire
composer require maatwebsite/excel
composer require barryvdh/laravel-dompdf
composer require laravel/sanctum

php artisan jetstream:install livewire
php artisan vendor:publish --provider="Barryvdh\DomPDF\ServiceProvider"
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
php artisan key:generate
php artisan storage:link

npm install


php artisan migrate


composer install --ignore-platform-reqs --no-plugins
.env


php artisan make:model Organization -m

php artisan migrate:fresh --seed



https://laravel-excel.com/
https://laravel-livewire.com/docs/2.x/quickstart
https://jetstream.laravel.com/installation.html



on NGINX 
cd /var/www/html/WEB-portal

# 1) make web user the owner (adjust user: www-data | nginx | apache)
sudo chown -R www-data:www-data storage bootstrap/cache

# 2) give write perms: dirs 775, files 664
sudo find storage bootstrap/cache -type d -exec chmod 775 {} +
sudo find storage bootstrap/cache -type f -exec chmod 664 {} +

# 3) (optional) clear caches to force rebuild
php artisan cache:clear
php artisan view:clear


npm install
npm run build


//missing auth do this
# FILE: scripts/reinstall-jetstream-livewire.sh
# why: end-to-end clean scaffold for Jetstream + Livewire (Laravel 12, PHP 8.3)

set -euo pipefail

# 0) Safety: ensure a clean working tree
git add -A && git commit -m "pre-jetstream-reinstall backup" || true

# 1) Remove custom auth bits that fight Jetstream/Fortify
#    - delete any hand-made /login routes or controllers
#    - delete any leftover resources/views/auth/*.blade.php to let Jetstream regenerate
sed -i.bak '/Route::get(.*\/login/d;/Route::post(.*\/login/d;/Route::post(.*\/logout/d' routes/web.php || true
rm -rf resources/views/auth || true
rm -f app/Http/Controllers/Auth/LoginController.php || true

# 2) Clear caches (important when views were missing previously)
php artisan route:clear || true
php artisan view:clear || true
php artisan config:clear || true
php artisan cache:clear || true

# 3) (Re)install packages
composer require laravel/jetstream livewire/livewire

# 4) Scaffold Jetstream with Livewire stack (creates auth views/components)
php artisan jetstream:install livewire

# Optional: if you need the raw Blade files in your app to customize
php artisan vendor:publish --tag=jetstream-views || true

# 5) Ensure Fortify renders Blade views (Jetstream expects this)
#    If config/fortify.php doesn't exist, publish it:
php artisan vendor:publish --provider="Laravel\Fortify\FortifyServiceProvider" || true

# Enforce 'views' => true in config/fortify.php
php -r '
$f="config/fortify.php";
if (file_exists($f)) {
  $s=file_get_contents($f);
  $s=preg_replace("/(\x27views\x27\s*=>\s*)false/","$1true",$s);
  file_put_contents($f,$s);
}
'

# 6) Build frontend assets (Jetstream UI)
# Use your preferred package manager; defaulting to npm here
npm install
npm run build

# 7) Run migrations if not already
php artisan migrate

# 8) Double-check Jetstream stack setting
php -r '
$f="config/jetstream.php";
if (file_exists($f)) {
  $s=file_get_contents($f);
  $s=preg_replace("/(\x27stack\x27\s*=>\s*)\x27inertia\x27/","$1\x27livewire\x27",$s);
  if (strpos($s, "stack") !== false) file_put_contents($f,$s);
}
'

# 9) Final cache clear & route check
php artisan optimize:clear
php artisan route:list | grep -E " login|logout" || true

echo "âœ… Jetstream + Livewire reinstalled. Try: php artisan serve, then open http://127.0.0.1:8000/login"

















